(function(){
"use strict";
console.log('JS linked');

// Object of the game
// player clicks start to generate random order of colors
// colors need to fade out in on time out fade out
// player then needs to click the color generated in order of the random display in order to continue

var sequence = ["#red", "#blue", "#green", "#yellow"];
var usedSequence = [];
var clickIndex = 0;
var round = 0;

// Function to generate random sequence
function randomSequence () {
	var random = Math.floor(Math.random() * sequence.length);
	return sequence[random];
};
// Function to flash the used sequence
function flashUsedSequence () {
	usedSequence.forEach(function(element, index) {
		setTimeout(function() {
				$(element).animate({
					opacity: "1"
				}, 800).animate({
					opacity: "0.5"
				}, 200)
			}, index * 1000);
	})
}

// Functions for playing game
function startSequence() {
	clickIndex = 0;
	var randomColor = randomSequence();
	usedSequence.push(randomColor);    // push random color generated to usedSequence array
	flashUsedSequence();
}
// Function to compare player click to color generated by the startSequence function.
function playGame() {
	$('.box').click(function() {
		var clickId = "#" + this.id;
		console.log(clickId);
		if(clickId === usedSequence[clickIndex]) {
			clickIndex += 1;
			if(clickIndex == usedSequence.length) {
				clickIndex = 0;
				round++;
				$('#round').html('Round: ' + round);
				setTimeout(function() {
					startSequence();
				}, 1500);
			}
		} else {
			location.reload();   // when matches are not made alert and reload page to start new game
			alert('Game Over!');
		}
	});
}

// Function to animate the box that the player clicks on
function animateClickedBox() {
	$('.box').click(function() {
		$('#' + this.id).animate({
			opacity: "1"
		},200).animate({
			opacity: "0.5"
		},800)
	});
}

// Function that clears the game by reloading the page
function clearGame() {
	location.reload();
}

// Event listeners for clicks
$('#start').click(function() {
	startSequence();
	playGame();
	animateClickedBox();
	$('#start').attr('disabled', true);
});

$('#reset').click(function() {
	clearGame();
});

})();
